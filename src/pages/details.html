<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登陆注册</title>
    <!-- <link rel="stylesheet" href="../css/zhuce.css"> -->
    <link rel="stylesheet" type="text/css" href="../font/iconfont.css">
    <link rel="stylesheet" href="../css/details.css">
</head>
<body>
    <nav>
        <div class="current nav-only">
            <img src="../images/logo.png" alt="">
            <ul class="nav-only-left">
                <li><a href="../pages/index.html">首页</a></li>
                <li><a href="./cakedetail.html">蛋糕详情页</a></li>
                <li>面包</li>
                <li>冰淇淋</li>
                <li>详情页加data.json</li>
                <li>全国送</li>
                <li><a href="./timerout.html">限时抢购</a></li>
            </ul>
            <ul class="nav-only-right">
                <li>
                    APP下载
                    <span class="nav-only-right-first-span"><img src="../images/xiazaiapp.png" alt=""></span>
                </li>
                <li class="location"><span>深圳</span>
                    <span class="iconfont down">&#xe665;</span>
                    <ol>
                        <li>中国大陆</li>
                        <li>香港</li>
                        <li>宜春</li>
                        <li>南昌</li>
                        <li>中国大陆</li>
                        <li>上海</li>
                        <li>北京</li>
                    </ol>
                </li>
                <li id="uname"><a href="../pages/login.html">登录</a>/<a href="#">注册</a></li>
                <li class="mes">
                    <span>消息</span>
                    <ol>
                        <li><a href="#">添加</a></li>
                        <li><a href="#">物流</a></li>
                    </ol>
                </li> 
                <li><a href="#" id="gowu" class="iconfont gouwuche">&#xe610;</a></li>
            </ul>
        </div>
    </nav>
    <main>
        <div class="main-only current">
            <div class="tagelist">
                <div class="tage-list">
                    <dl>
                        <dt>分类:</dt>
                        <dd>全部分类</dd>
                        <dd>蛋糕</dd>
                        <dd>冰麒麟</dd>
                        <dd>油条</dd>
                        <dd>大棒子</dd>
                    </dl>
                </div>
                <div class="cart-list">
                    <dl>
                        <dt>口味:</dt>
                        <dd class="cart-list-in-dl">全部口味</dd>
                        <dd>乳脂奶油</dd>
                        <dd>慕斯</dd>
                        <dd>乳酪巧克力</dd>
                        <dd>坚果</dd>
                        <dd>水果</dd>
                        <dd>咖啡冰淇淋</dd>
                    </dl>
                </div>
            </div>
            <div class="main-only-box">
            </div>

        </div>
    </main>
    <footer>
        <div class="footer-top">
            <div class="footer-col footer-col-brand">
                <img class="footer-logo" src="../images/23.png" height="36" width="96" alt="21cake"/><br>
                <img class="footer-solgan" src=""/>
                <p>始终为人类<br>提供优秀食物</p>
                <a href="http://weibo.com/21cake" target="_blank">
                    <img src="../images/24.png">
                </a><br>
                <a class="footer-icon" data-ewmsrc="//static.21cake.com/themes/site/img/erweima.png">
                    <img src="../images/25.png">
                </a><br>
                <a class="footer-icon" data-ewmsrc="//static.21cake.com/themes/site/img/footer-erweima.png">
                    <img src="../images/26.png">
                </a><br>
                <div class="footer-erweima footer"></div>
            </div>
            <div class="footer-col footer-col-nav">
                <p class="footer-col-title">关于我们</p>
                <p>联系我们</p>
                <p class="footer-light">
                    订购专线：400 650 2121
                    （服务时间 08:00–22:00）；<br />
                    企业团购热线：021-37768380；<br />
                    客服电话：021-23099721（全国）；<br />
                    kefu@21cake.com（邮箱）；
                </p>
                <a href="#">订购帮助</a><br>
                <a href="#">企业合作</a><br>
                <a href="#">生产经营资质</a><br>
                <a href="#">公告专区</a><br>
            </div>
            <div class="footer-col footer-col-tips">
                <p class="footer-col-title">订购时间</p>
                <p class="footer-light">
                    杭州/广州：提前5小时预订；<br />
                    北京：提前6小时预订；<br />
                    上海：提前5.5-6小时预订；<br />
                    天津/苏州/无锡/深圳：提前8小时预订（部分偏远地区除外，当日22点以后订单，于次日8点开始审核）
                    <span>当日蛋糕配送截止下单时间：北京/上海：16:30；杭州/广州：14:00；天津：10:30；苏州/无锡/深圳：11:00</span>
                </p>
            </div>
            <div id="f2" class="footer-col footer-col-about">
                <p class="footer-col-title">网络运营</p>
                <p class="footer-light">
                    网站注册公司名称: 北京廿一客食品有限公司 地址: 北京市北京经济技术开发区兴海二街5号院3号楼<br>
                    网站运营：廿一客（上海）电子商务有限公司 地址：上海市松江区新效支路518号<br>
                    上海廿一客食品有限公司分公司 地址：上海市松江区新效支路518号<br>
                    杭州廿一客食品有限公司 地址：杭州市滨江区秋溢路500号<br>
                    广州廿一客食品有限公司 地址：广州市南沙区东涌镇鱼窝头大道段   <br>   
                    北京廿一客食品有限公司 地址：北京市北京经济技术开发区兴海二街5号院<br>
                    深圳廿一客贸易有限公司 地址：深圳市福田区星河世纪大厦A栋1717  <br>       
                    天津廿一客食品有限公司 地址：天津市河西区麦收大厦2-2004<br>
                    广州廿一客食品贸易有限公司 地址：广州市南沙区东涌镇鱼窝头大道段 <br>
                    举实（上海）食品有限公司 地址：上海市松江区新效支路518号
                </p>
            </div>
        </div>
        <div class="footer-bottom">
            Copyright© 21Cake蛋糕官网商城 2007-2020, 版权所有 京ICP备14006254号-1 京公网安备 11030102010682号
        </div>
    </footer>
</body>
<script src="../js/header.js"></script>
<script src="../lib/jQuery/jquery.min.js"></script>
<script>
    var _li = document.getElementById("uname")
    let cname = document.cookie.split("=")[1]
    if (cname) {
        _li.innerHTML = cname
    }
    // var delGouWu=document.getElementsByClassName('gouwuche');
    var $box=document.getElementsByClassName("main-only-box")[0]
    function ajaxDetal(url="../lib/date.json",json){
        var xhr=new XMLHttpRequest();
        xhr.open("POST",url);
        xhr.setRequestHeader('content-type', 'application/x-www-form-urlencoded');
        if(json){
            xhr.send(json);
        }else{
            xhr.send()
        }
        xhr.onreadystatechange=function(){
            if(xhr.responseText&&xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 300)) {
                const jsona = JSON.parse(xhr.responseText);
                var str = "";
                for (var i = 0; i < jsona.length; i++) {
                    str += `<dl>
                    <dt><img src="${jsona[i].b}" alt=""><span>新品</span></dt>
                    <dd class="goodname">${jsona[i].a}</dd>
                    <dd class="box-money">${jsona[i].c}</dd>
                    <dd>
                        <span>新品</span>
                        <span class="goodename">${jsona[i].a}</span>
                    </dd>
                    <dd><a href="#" id="gowu" class="iconfont gouwuche">&#xe610;</a>&nbsp加入购物车</dd>
                </dl>`
                }
                $box.innerHTML += str;
                let del = document.getElementsByClassName("gouwuche");
                del=Array.from(del).splice(1);
                for (var i = 0; i < del.length; i++) {
                    del[i].index = i%12;
                    del[i].parentNode.onclick = function () {
                        var json = `usename=${document.cookie.split("=")[1]}&img=${this.parentNode.children[0].children[0].src}&goodname=${this.parentNode.children[1].innerText}&sv=${jsona[this.children[0].index].c}&num=1`
                        ajaxDetal("../lib/goodselect.php", json);
                        // 把上面的请求设置为同步  可以知道我们完成上面请求过后再去完成查询和页面渲染的功能
                    }
                }
            }
        }
    }
    ajaxDetal("../lib/date.json");
    var timer=null;
    document.onscroll=function(e){
        var oTop=$('html').height()-$(window).height()-$('html').scrollTop()
        if(oTop<300){
            clearTimeout(timer)
            timer=setTimeout(ajaxDetal,1000)
        }
    }
</script>
</html>