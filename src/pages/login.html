<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登陆注册</title>
    <link rel="stylesheet" href="../css/login.css">
    <link rel="stylesheet" type="text/css" href="../font/iconfont.css">
</head>

<body>
    <nav>
        <div class="current nav-only">
            <img src="../images/logo.png" alt="">
            <ul class="nav-only-left">
                <li><a href="../pages/index.html">首页</a></li>
                <li>蛋糕</li>
                <li><a href="./cakedetail.html">蛋糕详情页</a></li>
                <li>冰淇淋</li>
                <li id="uname"><a href="./details.html">（详情页加ajax）</a></li>
                <li>全国送</li>
                <li><a href="./timerout.html">限时抢购</a></li>
            </ul>
            <ul class="nav-only-right">
                <li>
                    APP下载
                    <span class="nav-only-right-first-span"><img src="../images/xiazaiapp.png" alt=""></span>
                </li>
                <li class="location"><span>深圳</span>
                    <span class="iconfont down">&#xe665;</span>
                    <ol>
                        <li>中国大陆</li>
                        <li>香港</li>
                        <li>宜春</li>
                        <li>南昌</li>
                        <li>中国大陆</li>
                        <li>上海</li>
                        <li>北京</li>
                    </ol>
                </li>
                <li><a href="#">登录</a>/<a href="../pages/zhuce.html">注册</a></li>
                <li class="mes">
                    <span>消息</span>
                    <ol>
                        <li><a href="#">添加</a></li>
                        <li><a href="#">物流</a></li>
                    </ol>
                </li>
                <li><a href="#" id="gowu" class="iconfont gouwuche">&#xe610;</a></li>
            </ul>
        </div>
    </nav>
    <main>
        <div class="main-only current">
            <div class="main-only-1">
                <p class="main-only-1-p"><span class="spans" index="0">账号密码登录</span>&nbsp|&nbsp<span class=""
                        index="1">手机验证码登录</span></p>
                <form id="zhang">
                    <input class="in1" type="text" placeholder="亲输入账号" name="usename" required><br>
                    <input class="in1" type="password" placeholder="亲输入密码" name="passward" required><br>
                    <button class="sub">登录</button><br>
                    记住账号：<input type="checkbox" checked><a href="#">忘记密码</a><a href="zhuce.html">重新注册</a>
                </form>
                <form id="mobile">
                    <input class="in1" type="text" placeholder="亲输入手机号" required><br>
                    <input class="in2 in1" type="text" placeholder="亲输入验证码" required><span>获取验证码</span><br>
                    <button class="sub">登录</button><br>
                    记住账号：<input type="checkbox" checked><a href="#">忘记密码</a><a href="zhuce.html">重新注册</a>
                </form>
            </div>
        </div>
    </main>
    <footer>
        <div class="footer-top">
            <div class="footer-col footer-col-brand">
                <img class="footer-logo" src="../images/23.png" height="36" width="96" alt="21cake" /><br>
                <img class="footer-solgan" src="" />
                <p>始终为人类<br>提供优秀食物</p>
                <a href="http://weibo.com/21cake" target="_blank">
                    <img src="../images/24.png">
                </a><br>
                <a class="footer-icon" data-ewmsrc="//static.21cake.com/themes/site/img/erweima.png">
                    <img src="../images/25.png">
                </a><br>
                <a class="footer-icon" data-ewmsrc="//static.21cake.com/themes/site/img/footer-erweima.png">
                    <img src="../images/26.png">
                </a><br>
                <div class="footer-erweima footer"></div>
            </div>
            <div class="footer-col footer-col-nav">
                <p class="footer-col-title">关于我们</p>
                <p>联系我们</p>
                <p class="footer-light">
                    订购专线：400 650 2121
                    （服务时间 08:00–22:00）；<br />
                    企业团购热线：021-37768380；<br />
                    客服电话：021-23099721（全国）；<br />
                    kefu@21cake.com（邮箱）；
                </p>
                <a href="#">订购帮助</a><br>
                <a href="#">企业合作</a><br>
                <a href="#">生产经营资质</a><br>
                <a href="#">公告专区</a><br>
            </div>
            <div class="footer-col footer-col-tips">
                <p class="footer-col-title">订购时间</p>
                <p class="footer-light">
                    杭州/广州：提前5小时预订；<br />
                    北京：提前6小时预订；<br />
                    上海：提前5.5-6小时预订；<br />
                    天津/苏州/无锡/深圳：提前8小时预订（部分偏远地区除外，当日22点以后订单，于次日8点开始审核）
                    <span>当日蛋糕配送截止下单时间：北京/上海：16:30；杭州/广州：14:00；天津：10:30；苏州/无锡/深圳：11:00</span>
                </p>
            </div>
            <div id="f2" class="footer-col footer-col-about">
                <p class="footer-col-title">网络运营</p>
                <p class="footer-light">
                    网站注册公司名称: 北京廿一客食品有限公司 地址: 北京市北京经济技术开发区兴海二街5号院3号楼<br>
                    网站运营：廿一客（上海）电子商务有限公司 地址：上海市松江区新效支路518号<br>
                    上海廿一客食品有限公司分公司 地址：上海市松江区新效支路518号<br>
                    杭州廿一客食品有限公司 地址：杭州市滨江区秋溢路500号<br>
                    广州廿一客食品有限公司 地址：广州市南沙区东涌镇鱼窝头大道段 <br>
                    北京廿一客食品有限公司 地址：北京市北京经济技术开发区兴海二街5号院<br>
                    深圳廿一客贸易有限公司 地址：深圳市福田区星河世纪大厦A栋1717 <br>
                    天津廿一客食品有限公司 地址：天津市河西区麦收大厦2-2004<br>
                    广州廿一客食品贸易有限公司 地址：广州市南沙区东涌镇鱼窝头大道段 <br>
                    举实（上海）食品有限公司 地址：上海市松江区新效支路518号
                </p>
            </div>
        </div>
        <div class="footer-bottom">
            Copyright© 21Cake蛋糕官网商城 2007-2020, 版权所有 京ICP备14006254号-1 京公网安备 11030102010682号
        </div>
    </footer>
</body>
<script src="../js/header.js"></script>
<script>
    var _p = document.getElementsByClassName("main-only-1-p")[0];
    var _span = _p.children
    var _form = document.querySelectorAll("form")
    var _sub = document.querySelectorAll(".sub")
    var _data = document.querySelectorAll(".in1")
    _p.onclick = function (e) {
        var e = window.event || e;
        var target = e.target || e.srcElemnet;
        if (target.nodeName == "SPAN") {
            for (let i = 0; i < _form.length; i++) {
                _form[i].style.zIndex = 0
                _span[i].className = ""
                _span[i].index = i
            }
            target.className = "spans"
            _form[target.index].style.zIndex = 100
        }
    }
    //表单请求
    var index=0
    var form = new FormData();
    for (let i = 0; i < 2; i++) {
        _sub[i].index=i
        _sub[i].onclick = function () {
            index=this.index
            ajaxPost("../lib/login.php", `${this.parentNode.children[0].name} = ${this.parentNode.children[0].value}&${this.parentNode.children[2].name} = ${this.parentNode.children[2].value}`)
            // $.ajax({
            //     url:"./login.php?usename=qweqwe&pas=123123",
            //     dataType:"json",
            //     success(res){
            //         console.log(res);
            //     },error(err){
            //         console.log(err);
            //     }
            // })
            return false
        }
    }
    _data[1].onblur=function(){
        _sub[index].innerText="登录"
    } 
    function ajaxPost(url, json) {
        var xhr = new XMLHttpRequest()
        xhr.open("POST", url)
        xhr.setRequestHeader('content-type', 'application/x-www-form-urlencoded')
        xhr.send(json)
        xhr.onreadystatechange = function(){
            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 300)) {
                if(xhr.responseText=="true"){
                    document.cookie="usename"+"="+`${_sub[index].parentNode.children[0].value}`
                    location.assign("./index.html");
                    // console.log(_sub[index].parentNode.children[0].value);
                }else{
                    _sub[index].innerText="账号密码错误";
                }
                // 
            }
        }
    }
    
</script>
</html>